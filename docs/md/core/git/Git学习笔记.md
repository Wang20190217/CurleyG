# Git学习笔记

## 1.课程综述

### VCS出现前

开始之前。让我们先了解一下版本控制系统的演变历史，以及关于课程的主要内容，在版本控制系统出现之前。

![image-20241124211140638](https://curleyg-1311489005.cos.ap-shanghai.myqcloud.com/202411242111271.png)

  我20多年前，我那个时候在研究生实验室里面跟同学们一起做项目开发。那时候还没有版本控制系统，那我们怎么开发的呢，就是在一台服务器上面把文件共享出来，然后呢，各自建个文件夹。就是以这种目录拷贝的方式。不同的人开发的东西以及各自开发自己开发的这个文件，也通过这种文件夹的形式标上一点零二点零三点表示版本号。基本就是这样的开发状态，那这种情况呢？我个人感觉啊，就是大家一起开发的公共文件是非常容易被覆盖的情况。还有开发的时候，我得不停的跟别人说，哎，我现在正在开发这个，你们先不要动啊，这样所以沟通成本是非常高的。因此，整个项目集成下来，集成效率非常低下的。而现在我到了携程工作的时候，我会去问新的同事，我说现在大学里面你们做毕业设计或者开发的时候，你们是怎么玩的？很多人告诉我，他们也没有版本控制系统。所以我个人认为，把类似于git这样的这种版本控制系统。推荐给大家是非常有必要的，那我们看到了就说右图这边这种以目录拷贝区别不同版本的这种形式。过去现在也还存在，当然时代发展了，在这几十年当中呢，已经有很多开源的，或者是商业化的版本。

### 集中式版本控制系统

![image-20241124211206626](https://curleyg-1311489005.cos.ap-shanghai.myqcloud.com/202411242112456.png)

其中像cvs和SVN这种集中式的版本控制系统。也曾经被很多团队所喜欢，所接受，集中式的版本控制系统它具备的什么样？

它有一个集中的版本管理服务器，这个服务器存放了整个项目的。每个文件乃至每个文件夹一个一个的版本演变的历史，也就是说哪一天你本地。没有这套文件，从版本控制系统的服务器取也是非常容易的，它已经把历史当中的出现的这个文件呢，演变的历史一个一个的都存在了。因此呢，它具备了这种提供大家历史上的这个版本的搜索的能力，以及不同版本之间的比较的这个能力都具备了。还有它也具备这种分支管理的能力，可以让不同的分支一起做集成。那么，这样的这个特征使得集中式的版本控制系统比起之前没有版本控制系统做集成的呢？它整个的项目的效率。在集成方面是有提高的，不过啊，这个集中式的版本控制系统，大家可以看到这个computer A跟版本控制系统之间，它是不具备整像服务器一样的一个完整的版本历史。computer b也是一样的，因此这些客户端它必须时刻刻的和服务器相连来保持自己始终处于一个完整状态。那么有很多人认为，这种集中式的版本控制系统在这个速度方面是存在不足的，像林尼克斯的内核开发者林纳斯，他就有这种观点。他就是不接受cvs和svn。那么后来呢，又有一些人针对集中式的控制系统存在的不足呢，所以呢，就创造出了**分布式**的控制系统。

### 分布式版本控制系统

![image-20241124211239892](https://curleyg-1311489005.cos.ap-shanghai.myqcloud.com/202411242112296.png)

分布式版本控制系统和集中式的控制系统，很大的一个差异是：

客户端使用的都有完整的一套版本库，那脱离服务端客户端是照样可以管理版本的。并且。历史以及版本比较等多数这种。版本之间的这种相关的操作都不需要去访问服务器。说分布式的控制系统比集中式的控制系统更能提高版本管理的效率。

分布式的控制系统曾经有一款商业的工具叫做bit keep，那这款也曾经提供给linux的开源的这种社区使用。但是后来是因为商业化的原因，那么像林老师，他们呢，就不能够享受bit keep的这款工具了。逼着李娜斯开发出了git，这款款本控制系统。当迪特出来的时候，很多人还对他发生质疑了，但是不久之后，因为迪特他具备的特点非常特点。导致了开源社区过了没多久就陆陆续续的都采纳git ，从SVN转移到git来进行版本控制。

![image-20241124211303314](https://curleyg-1311489005.cos.ap-shanghai.myqcloud.com/202411242113544.png)

git具备什么样的特征呢？

最优的存储能力，非凡的性能 得益于尼纳斯本身的这个能，他是内核专家，也是文件系统的管理专家。所以它开发出来的git具备了最优的存储能力以及防的性能啊，

李老师他本身就是崇尚开源的，所以他开发的给他也是开源的。

git它还很容易做备份

支持离线的操作

基于git它的分支管理的成本是非常低的。而且常容易定制工作流程。



![image-20241124211320218](https://curleyg-1311489005.cos.ap-shanghai.myqcloud.com/202411242113636.png)

git具有这么多的优点，git相对成熟之后，后面就开源的，或者说是商业化的，这种基于git做web服务的平台就出现了github和gitLab。

主要的重心首先是大家学会如何使用git以及了解git的工作原理。

其次，现在dev ops无处不在。开发运维这套要打破壁垒，能够提供快速，持续交付的这样一个环境的这种平台也是雨后春笋般的出现。

包括github，我们是不能不讲的，为什么呢？它是我们全球最大的开源社区，里面有非常好的开源项目值得大家借鉴，同时github除了自己开发了这个代码管理。代码评审项目管理相关这些功能以外，它还引入了跟第三方公司就它有个github的市场，这个市场里面把其他好的代码质量以及持续集成的这个工具都纳入到了当中，那么整个github提供代码。存储再加上它的商业化的合作伙伴，提供这种持续交付，持续集成的这种环境，那整个的dev ops的。全流程生命周期的这样一个平台，也就诞生了。那么github，那我们肯定要教大家学会，而且是在上面要。高的项目，这点也可以分享给大家好，

那么聊了github还得聊一聊gitLab为什么呢？

因为这个它有一个社区版本，现在很多公司呢，就是很喜欢getlab的这一块的这个，因为它又是开源的，同时，它自带了gitlab的ci，这一点是它跟github所不一样的。比如说我们的这个阿里云平台用的也是git lab，还有包括点评，去哪儿，携程一系列的公司也是在getlab的基础上做自己的代码平台的二次开发，所以呢，我们不妨也把getlab介绍给大家。那整个的话。这个课程会围绕着git以及基于git的这种dev ops，这种持续交付实践如何开展？那我们主要是围绕这个内容进行讲解的。

## 2.git安装

可以访问官方文档进行安装：

https://git-scm.com/book/zh/v2

![image-20241124214718131](https://curleyg-1311489005.cos.ap-shanghai.myqcloud.com/202411242147557.png)

安装的时候一直下一步就是了。

安装是否成功

```shell
C:\Users\CurleyG>git --version //输入命令
git version 2.39.2.windows.1   //返回了git版本
```

## 3.使用git之前需要最小的配置

配置user.name和user.email

```shell
git config --global user.name "your_username"
git config --global user.email "your_email"
```

**config 的三个作用域（优先级从上到小依次递减）：**

- local 只对某个仓库有效
- global 对当前用户所有仓库有效
- system 对系统所有登录的用户有效

显示config的配置，加--list

```shell
git config --list --local 
git config --list --global  
git config --list --system  
```

## 4.创建一个版本仓库，设置local信息

1.把已有的项目纳入Git管理

```shell
cd 项目代码所在的文件夹

执行 git init 
```

2.新建的项目直接使用Git管理

```shell
cd 某个文件夹
执行 git init your_project_name 命令   //name 为项目名称
cd your_project_name  //进入项目
```

3.往项目添加一个文件

```shell
cp 文件所在路径 文件目标路径
```

4.第一次添加的文件需要先执行git add(添加到暂存区)才可以commit

```shell
git add 文件名  //添加文件到暂存区 文件名可多个 也可以是文件夹
git add -u //用于将所有已经跟踪过的文件的更改标记为要提交的状态，没有跟踪的不会提交

```

5.提交文件

```shell
git commit -m'提交描述'

PS F:\wang> git commit -m'Add readme'
[master (root-commit) c9d2b49] Add readme
 1 file changed, 392 insertions(+)
 create mode 100644 "\351\241\271\347\233\256\347\273\223\346\236\204.md"
```

6.查询git目前状态

```shell
git status
```

7.查询git 日志

```shell
git log

PS F:\wang> git log
commit c9d2b490d2bc8139c0b0c96aa52bdc7dae8da53b (HEAD -> master) //提交的id 提交的分支
Author: curleyg <curleyg@163.com>  //完成提交的作者 以及 邮箱
Date:   Sun Nov 24 22:18:41 2024 +0800 //提交日期
```

## 5.认识工作区和暂存区

![image-20241124222619917](https://curleyg-1311489005.cos.ap-shanghai.myqcloud.com/202411242226496.png)

git管理目录的文件会尽力三个过程：

1.第一次添加到工作目录当中首先需要执行git add 添加到暂存区

2.文件没有问题，可以执行git commit 提交到版本历史

## 6.给文件重命名的简便方法

### 方式一

```shell
mv readme readme.md //修改文件名
git add readme.md //添加修改后的文件
git rm readme //删除文件


```

`git reset --hard` 是一个非常强大的命令，它可以将您的工作目录和暂存区恢复到最近一次提交的状态。具体来说，它会执行以下几个操作：

1. **重置索引**：将索存区（即即将提交的文件列表）重置为最后一次提交的状态。
2. **重置工作目录**：将工作目录中的文件恢复到最后一次提交的状态，这会丢弃所有未提交的更改。

使用场景

- **撤销未提交的更改**：如果您对一些文件进行了修改，但还没有提交，使用 `git reset --hard` 可以撤销这些更改，将文件恢复到最后一次提交的状态。
- **清理工作目录**：如果您想快速地清除所有未提交的更改和未跟踪的文件，可以使用 `git reset --hard`。

注意事项

- **数据丢失风险**：`git reset --hard` 是一个不可逆的操作，一旦执行，所有未提交的更改将永久丢失。因此，在执行该命令前，请确保您不再需要这些更改。
- **备份工作**：如果您不确定是否要丢弃所有的更改，建议先将工作目录中的文件备份到另一个位置，然后再执行 `git reset --hard`。



### 方式二

```shell
git mv readme readme.md //一条命令抵上面三条指令
```

## 7.通过gitlog 查看版本历史

 `git log --oneline`（注意双破折号）。这个命令用于显示简洁的提交历史记录，每条提交信息只占用一行。

**显示当前分支提交：**

```shell
git log
```



**显示特定数量的提交**：

```
git log --oneline -n 5
```

这条命令会显示最近的 5 条提交记录。



**显示某个分支的提交记录：**

```
git log --oneline branch-name
```

这条命令会显示指定分支 `branch-name` 的提交记录。



**显示某个作者的提交记录：**

```
git log --oneline --author="作者名"
```

这条命令会显示指定作者的提交记录。



**显示所有分支的日志**：

```
git log --all
```

**显示分支的父子关系：**

```
git log --all --graph
```

![image-20241124230233585](https://curleyg-1311489005.cos.ap-shanghai.myqcloud.com/202411242302248.png)

```
git branch -v`
```

命令用于列出本地所有分支及其最新的提交信息



```
git checkout -b temp 415c5c8086e16399`
```

命令用于从指定的提交创建一个新的分支，并切换到该分支。这个命令结合了两个操作：

1. 创建一个新分支 `temp`。
2. 切换到新创建的分支 `temp`。
3. 将新分支的起点设置为指定的提交 `415c5c8086e16399`。